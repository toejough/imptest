version = '2'

[linters]
default = 'all'
disable = [
	'exhaustruct',    # too noisy for zero value structs
	'forbidigo',      # I print output on purpose sometimes
	'godox',          # saving todos till another validation step
	'ireturn',        # I like generic return types
	'nonamedreturns', # I like named returns
	'wsl',            # deprecated
]

[linters.settings]
[linters.settings.depguard]
[linters.settings.depguard.rules]
[linters.settings.depguard.rules.all]
files = ['$all', '!$test']
allow = [
	'$gostd',
	'github.com/alexflint/go-arg',
	'github.com/akedrou/textdiff',
	'github.com/davecgh/go-spew/spew',
	'github.com/dave/dst',
	'github.com/dave/dst/decorator',
	'github.com/dave/dst/dstutil',
	'golang.org/x/tools/go/packages',
	'github.com/toejough/imptest/UAT/run',
	'github.com/toejough/imptest/impgen/run',
	'github.com/toejough/imptest/impgen/reorder',
]

[linters.settings.depguard.rules.test]
files = ['$test']
allow = [
	'$gostd',
	'github.com/dave/dst',
	'github.com/dave/dst/decorator',
	'github.com/dave/dst/dstutil',
	'github.com/onsi/gomega',
	'pgregory.net/rapid',
	'github.com/toejough/imptest',
	'github.com/toejough/imptest/imptest',
	'github.com/toejough/imptest/UAT/run',
	'github.com/toejough/imptest/impgen/run',
	'github.com/toejough/imptest/impgen/reorder',
	'golang.org/x/tools/go/packages',
]

[linters.settings.nlreturn]
block-size = 2

[linters.settings.unused]
field-writes-are-uses = false
exported-fields-are-used = false
local-variables-are-used = false

[linters.exclusions]
generated = 'lax'
presets = ['comments', 'common-false-positives', 'legacy', 'std-error-handling']
paths = ['third_party$', 'builtin$', 'examples$']

[issues]
fix = true

[[linters.exclusions.rules]]
# Dynamic errors are acceptable and often clearer in test code/predicates.
path = "_test.go"
linters = ['err113']

[[linters.exclusions.rules]]
# UAT/11 intentionally uses a package name that conflicts with stdlib to test aliasing.
path = "UAT/11-package-name-conflicts"
linters = ['depguard', 'mnd', 'revive']

[formatters]
enable = ['gofmt', 'gofumpt', 'goimports']

[formatters.exclusions]
generated = 'lax'
paths = ['third_party$', 'builtin$', 'examples$']
