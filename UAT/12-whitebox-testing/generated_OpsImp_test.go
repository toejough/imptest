// Code generated by impgen. DO NOT EDIT.

package whitebox

import "github.com/toejough/imptest/imptest"
import "testing"
import "time"

// OpsImp is the test controller for mocking the interface.
// Create with NewOpsImp(t), then use Mock field to get the mock implementation
// and ExpectCallIs field to set expectations for method calls.
//
// Example:
//
//	imp := NewOpsImp(t)
//	go codeUnderTest(imp.Mock)
//	imp.ExpectCallIs.MethodName().ExpectArgsAre(...).InjectResult(...)
type OpsImp struct {
	*imptest.Controller[*OpsImpCall]
	Mock         *OpsImpMock
	ExpectCallIs *OpsImpExpectCallIs
	currentCall  *OpsImpCall
}

// NewOpsImp creates a new test controller for mocking the interface.
// The returned controller manages mock expectations and response injection.
// Pass t to enable automatic test failure on unexpected calls or timeouts.
//
// Example:
//
//	imp := NewOpsImp(t)
//	go codeUnderTest(imp.Mock)
//	imp.ExpectCallIs.Method().ExpectArgsAre(...).InjectResult(...)
func NewOpsImp(t *testing.T) *OpsImp {
	imp := &OpsImp{
		Controller: imptest.NewController[*OpsImpCall](t),
	}
	imp.Mock = &OpsImpMock{imp: imp}
	imp.ExpectCallIs = &OpsImpExpectCallIs{imp: imp}
	return imp
}

// GetCurrentCall returns the current call being processed.
// If no call is pending, waits indefinitely for the next call.
// Returns the existing current call if it hasn't been completed yet.
func (i *OpsImp) GetCurrentCall() *OpsImpCall {
	if i.currentCall != nil && !i.currentCall.Done() {
		return i.currentCall
	}
	i.currentCall = i.GetCall(0, func(c *OpsImpCall) bool { return true })
	return i.currentCall
}

// Within configures a timeout for expectations and returns a OpsImpTimed for method chaining.
// The timeout applies to subsequent expectation calls.
//
// Example:
//
//	imp.Within(100*time.Millisecond).ExpectCallIs.Method().ExpectArgsAre(...)
func (i *OpsImp) Within(d time.Duration) *OpsImpTimed {
	return &OpsImpTimed{
		ExpectCallIs: &OpsImpExpectCallIs{imp: i, timeout: d},
	}
}

// OpsImpCall represents a captured call to any method.
// Only one method field is non-nil at a time, indicating which method was called.
// Use Name() to identify the method and As{{Method}() to access typed call details.
type OpsImpCall struct {
	internalMethod *OpsImpinternalMethodCall
	PublicMethod   *OpsImpPublicMethodCall
}

// AsPublicMethod returns the call cast to OpsImpPublicMethodCall for accessing call details.
// Returns nil if the call was not to PublicMethod.
func (c *OpsImpCall) AsPublicMethod() *OpsImpPublicMethodCall {
	return c.PublicMethod
}

// AsinternalMethod returns the call cast to OpsImpinternalMethodCall for accessing call details.
// Returns nil if the call was not to internalMethod.
func (c *OpsImpCall) AsinternalMethod() *OpsImpinternalMethodCall {
	return c.internalMethod
}

// Done returns true if the call has been completed (response injected).
// Used internally to track call state.
func (c *OpsImpCall) Done() bool {
	if c.internalMethod != nil {
		return c.internalMethod.done
	}
	if c.PublicMethod != nil {
		return c.PublicMethod.done
	}
	return false
}

// Name returns the name of the method that was called.
// Returns an empty string if the call struct is invalid.
func (c *OpsImpCall) Name() string {
	if c.internalMethod != nil {
		return "internalMethod"
	}
	if c.PublicMethod != nil {
		return "PublicMethod"
	}
	return ""
}

// OpsImpExpectCallIs provides methods to set expectations for specific method calls.
// Each method returns a builder for fluent expectation configuration.
// Use Within() on the parent OpsImp to configure timeouts.
type OpsImpExpectCallIs struct {
	imp     *OpsImp
	timeout time.Duration
}

// PublicMethod returns a builder for setting expectations on PublicMethod method calls.
func (e *OpsImpExpectCallIs) PublicMethod() *OpsImpPublicMethodBuilder {
	return &OpsImpPublicMethodBuilder{imp: e.imp, timeout: e.timeout}
}

// internalMethod returns a builder for setting expectations on internalMethod method calls.
func (e *OpsImpExpectCallIs) internalMethod() *OpsImpinternalMethodBuilder {
	return &OpsImpinternalMethodBuilder{imp: e.imp, timeout: e.timeout}
}

// OpsImpMock provides the mock implementation of the interface.
// Pass OpsImpMock to code under test that expects the interface implementation.
// Use the parent OpsImp controller to set expectations and inject responses.
type OpsImpMock struct {
	imp *OpsImp
}

// PublicMethod implements the interface method and records the call for testing.
// The method blocks until a response is injected via the test controller.
func (m *OpsImpMock) PublicMethod(x int) int {
	responseChan := make(chan OpsImpPublicMethodCallResponse, 1)

	call := &OpsImpPublicMethodCall{
		responseChan: responseChan,
		x:            x,
	}

	callEvent := &OpsImpCall{
		PublicMethod: call,
	}

	m.imp.CallChan <- callEvent

	resp := <-responseChan

	if resp.Type == "panic" {
		panic(resp.PanicValue)
	}

	return resp.Result0
}

// internalMethod implements the interface method and records the call for testing.
// The method blocks until a response is injected via the test controller.
func (m *OpsImpMock) internalMethod(x int) int {
	responseChan := make(chan OpsImpinternalMethodCallResponse, 1)

	call := &OpsImpinternalMethodCall{
		responseChan: responseChan,
		x:            x,
	}

	callEvent := &OpsImpCall{
		internalMethod: call,
	}

	m.imp.CallChan <- callEvent

	resp := <-responseChan

	if resp.Type == "panic" {
		panic(resp.PanicValue)
	}

	return resp.Result0
}

// OpsImpPublicMethodBuilder provides a fluent API for setting expectations on PublicMethod calls.
// Use ExpectArgsAre for exact matching or ExpectArgsShould for matcher-based matching.
type OpsImpPublicMethodBuilder struct {
	imp     *OpsImp
	timeout time.Duration
}

// ExpectArgsAre waits for a PublicMethod call with exactly the specified argument values.
// Returns the call object for response injection. Fails the test if the call
// doesn't arrive within the timeout or if arguments don't match exactly.
// Uses == for comparable types and reflect.DeepEqual for others.
func (bldr *OpsImpPublicMethodBuilder) ExpectArgsAre(x int) *OpsImpPublicMethodCall {
	validator := func(callToCheck *OpsImpCall) bool {
		if callToCheck.Name() != "PublicMethod" {
			return false
		}
		methodCall := callToCheck.AsPublicMethod()
		if methodCall.x != x {
			return false
		}
		return true
	}

	call := bldr.imp.GetCall(bldr.timeout, validator)
	return call.AsPublicMethod()
}

// ExpectArgsShould waits for a PublicMethod call with arguments matching the given matchers.
// Use imptest.Any() to match any value, or imptest.Satisfies(fn) for custom matching.
// Returns the call object for response injection. Fails the test if the call
// doesn't arrive within the timeout or if any matcher fails.
func (bldr *OpsImpPublicMethodBuilder) ExpectArgsShould(x any) *OpsImpPublicMethodCall {
	validator := func(callToCheck *OpsImpCall) bool {
		if callToCheck.Name() != "PublicMethod" {
			return false
		}
		methodCall := callToCheck.AsPublicMethod()
		var ok bool
		ok, _ = imptest.MatchValue(methodCall.x, x)
		if !ok {
			return false
		}
		return true
	}

	call := bldr.imp.GetCall(bldr.timeout, validator)
	return call.AsPublicMethod()
}

// InjectPanic waits for a PublicMethod call and causes it to panic with the given value.
// This is a shortcut that combines waiting for the call with injecting a panic.
// Use this to test panic handling in code under test. Returns the call object for further operations.
func (bldr *OpsImpPublicMethodBuilder) InjectPanic(msg any) *OpsImpPublicMethodCall {
	validator := func(callToCheck *OpsImpCall) bool {
		return callToCheck.Name() == "PublicMethod"
	}

	call := bldr.imp.GetCall(bldr.timeout, validator)
	methodCall := call.AsPublicMethod()
	methodCall.InjectPanic(msg)
	return methodCall
}

// InjectResult waits for a PublicMethod call and immediately injects the return value.
// This is a shortcut that combines waiting for the call with injecting the result.
// Returns the call object for further operations. Fails if no call arrives within the timeout.
func (bldr *OpsImpPublicMethodBuilder) InjectResult(result int) *OpsImpPublicMethodCall {
	validator := func(callToCheck *OpsImpCall) bool {
		return callToCheck.Name() == "PublicMethod"
	}

	call := bldr.imp.GetCall(bldr.timeout, validator)
	methodCall := call.AsPublicMethod()
	methodCall.InjectResult(result)
	return methodCall
}

// OpsImpPublicMethodCall represents a captured call to the PublicMethod method.
// Use InjectResult to set the return value, or InjectPanic to cause the method to panic.
type OpsImpPublicMethodCall struct {
	responseChan chan OpsImpPublicMethodCallResponse
	done         bool
	x            int
}

// InjectPanic causes the mocked method to panic with the given value.
// Use this to test panic handling in code under test.
// The panic occurs in the goroutine where the mock was called.
func (c *OpsImpPublicMethodCall) InjectPanic(msg any) {
	c.done = true
	c.responseChan <- OpsImpPublicMethodCallResponse{Type: "panic", PanicValue: msg}
}

// InjectResult sets the return value for this method call and unblocks the caller.
// The mocked method will return the provided result value.
func (c *OpsImpPublicMethodCall) InjectResult(result int) {
	c.done = true
	c.responseChan <- OpsImpPublicMethodCallResponse{Type: "return", Result0: result}
}

// OpsImpPublicMethodCallResponse holds the response configuration for the PublicMethod method.
// Set Type to "return" for normal returns, "panic" to cause a panic, or "resolve" for void methods.
type OpsImpPublicMethodCallResponse struct {
	Type       string // "return", "panic", or "resolve"
	Result0    int
	PanicValue any
}

// OpsImpTimed provides timeout-configured expectation methods.
// Access via OpsImp.Within(duration) to set a timeout for expectations.
type OpsImpTimed struct {
	ExpectCallIs *OpsImpExpectCallIs
}

// OpsImpinternalMethodBuilder provides a fluent API for setting expectations on internalMethod calls.
// Use ExpectArgsAre for exact matching or ExpectArgsShould for matcher-based matching.
type OpsImpinternalMethodBuilder struct {
	imp     *OpsImp
	timeout time.Duration
}

// ExpectArgsAre waits for a internalMethod call with exactly the specified argument values.
// Returns the call object for response injection. Fails the test if the call
// doesn't arrive within the timeout or if arguments don't match exactly.
// Uses == for comparable types and reflect.DeepEqual for others.
func (bldr *OpsImpinternalMethodBuilder) ExpectArgsAre(x int) *OpsImpinternalMethodCall {
	validator := func(callToCheck *OpsImpCall) bool {
		if callToCheck.Name() != "internalMethod" {
			return false
		}
		methodCall := callToCheck.AsinternalMethod()
		if methodCall.x != x {
			return false
		}
		return true
	}

	call := bldr.imp.GetCall(bldr.timeout, validator)
	return call.AsinternalMethod()
}

// ExpectArgsShould waits for a internalMethod call with arguments matching the given matchers.
// Use imptest.Any() to match any value, or imptest.Satisfies(fn) for custom matching.
// Returns the call object for response injection. Fails the test if the call
// doesn't arrive within the timeout or if any matcher fails.
func (bldr *OpsImpinternalMethodBuilder) ExpectArgsShould(x any) *OpsImpinternalMethodCall {
	validator := func(callToCheck *OpsImpCall) bool {
		if callToCheck.Name() != "internalMethod" {
			return false
		}
		methodCall := callToCheck.AsinternalMethod()
		var ok bool
		ok, _ = imptest.MatchValue(methodCall.x, x)
		if !ok {
			return false
		}
		return true
	}

	call := bldr.imp.GetCall(bldr.timeout, validator)
	return call.AsinternalMethod()
}

// InjectPanic waits for a internalMethod call and causes it to panic with the given value.
// This is a shortcut that combines waiting for the call with injecting a panic.
// Use this to test panic handling in code under test. Returns the call object for further operations.
func (bldr *OpsImpinternalMethodBuilder) InjectPanic(msg any) *OpsImpinternalMethodCall {
	validator := func(callToCheck *OpsImpCall) bool {
		return callToCheck.Name() == "internalMethod"
	}

	call := bldr.imp.GetCall(bldr.timeout, validator)
	methodCall := call.AsinternalMethod()
	methodCall.InjectPanic(msg)
	return methodCall
}

// InjectResult waits for a internalMethod call and immediately injects the return value.
// This is a shortcut that combines waiting for the call with injecting the result.
// Returns the call object for further operations. Fails if no call arrives within the timeout.
func (bldr *OpsImpinternalMethodBuilder) InjectResult(result int) *OpsImpinternalMethodCall {
	validator := func(callToCheck *OpsImpCall) bool {
		return callToCheck.Name() == "internalMethod"
	}

	call := bldr.imp.GetCall(bldr.timeout, validator)
	methodCall := call.AsinternalMethod()
	methodCall.InjectResult(result)
	return methodCall
}

// OpsImpinternalMethodCall represents a captured call to the internalMethod method.
// Use InjectResult to set the return value, or InjectPanic to cause the method to panic.
type OpsImpinternalMethodCall struct {
	responseChan chan OpsImpinternalMethodCallResponse
	done         bool
	x            int
}

// InjectPanic causes the mocked method to panic with the given value.
// Use this to test panic handling in code under test.
// The panic occurs in the goroutine where the mock was called.
func (c *OpsImpinternalMethodCall) InjectPanic(msg any) {
	c.done = true
	c.responseChan <- OpsImpinternalMethodCallResponse{Type: "panic", PanicValue: msg}
}

// InjectResult sets the return value for this method call and unblocks the caller.
// The mocked method will return the provided result value.
func (c *OpsImpinternalMethodCall) InjectResult(result int) {
	c.done = true
	c.responseChan <- OpsImpinternalMethodCallResponse{Type: "return", Result0: result}
}

// OpsImpinternalMethodCallResponse holds the response configuration for the internalMethod method.
// Set Type to "return" for normal returns, "panic" to cause a panic, or "resolve" for void methods.
type OpsImpinternalMethodCallResponse struct {
	Type       string // "return", "panic", or "resolve"
	Result0    int
	PanicValue any
}

// unexported variables.
var (
	// Compile-time verification that OpsImpMock implements Ops.
	_ Ops = (*OpsImpMock)(nil)
)
